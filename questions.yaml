questions:
  - variable: application.logLevel
    label: "日志级别"
    description: "日志详细程度（info/warning/debug/error）"
    type: enum
    options:
      - info
      - warning
      - debug
      - error
    default: info
    group: "日志配置"

  - variable: application.logFormat
    label: "日志格式"
    description: "日志输出格式，推荐 json-pretty"
    type: enum
    options:
      - json-pretty
      - json
      - plain
    default: json-pretty
    group: "日志配置"

  - variable: application.features.automaticUnchangedApproval
    label: "自动批准未变更镜像"
    description: "若镜像引用未发生变更则自动通过"
    type: boolean
    default: false
    group: "功能特性"

  - variable: application.features.automaticChildApproval
    label: "自动批准子资源"
    description: "如由父资源创建的 Pod/Job 等"
    type: boolean
    default: true
    group: "功能特性"

  - variable: application.features.detectionMode
    label: "只警告不拒绝"
    description: "开启后校验失败只输出警告但不拒绝"
    type: boolean
    default: false
    group: "功能特性"

  - variable: application.features.namespacedValidation.mode
    label: "命名空间校验模式"
    description: "ignore=忽略所有命名空间注解，validate=仅校验有注解命名空间"
    type: enum
    options:
      - ignore
      - validate
    default: ignore
    group: "功能特性"

  - variable: application.features.resourceValidationMode
    label: "资源校验范围"
    description: "校验全部类型(all)或仅Pod(podsOnly)"
    type: enum
    options:
      - all
      - podsOnly
    default: all
    group: "功能特性"

  - variable: application.features.cache.expirySeconds
    label: "签名校验缓存时长(秒)"
    description: "校验缓存的有效秒数"
    type: int
    default: 30
    group: "功能特性"

  - variable: application.features.cache.cacheErrors
    label: "缓存校验失败"
    description: "是否对失败的校验结果也进行缓存"
    type: boolean
    default: true
    group: "功能特性"
    
  - variable: application.validators
    label: "校验器（validators）"
    description: |
      以 YAML 数组格式填写，可根据需要新增或删除校验器条目。
      ➤ 新增：复制下面的一个示例条目粘贴到下方，修改 name、type 等内容即可。
      ➤ 删除：直接删除相关条即可。

      示例（可参考编辑）：
        - name: allow
          type: static
          approve: true
        - name: deny
          type: static
          approve: false
        - name: dockerhub
          type: notaryv1
          trustRoots:
            - name: default
              key: |
                -----BEGIN PUBLIC KEY-----
                MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEOXYta5TgdCwXTCnLU09W5T4M4r9f
                QQrqJuADP6U7g5r9ICgPSmZuRHP/1AYUfOQW3baveKsT969EfELKj1lfCA==
                -----END PUBLIC KEY-----
            - name: sse
              key: |
                -----BEGIN PUBLIC KEY-----
                MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsx28WV7BsQfnHF1kZmpdCTTLJaWe
                d0CA+JOi8H4REuBaWSZ5zPDe468WuOJ6f71E7WFg3CVEVYHuoZt2UYbN/Q==
                -----END PUBLIC KEY-----
    type: multiline
    required: true
    group: "校验器"
    default: |-
      - name: allow
        type: static
        approve: true
      - name: deny
        type: static
        approve: false
      - name: dockerhub
        type: notaryv1
        trustRoots:
          - name: default
            key: |
              -----BEGIN PUBLIC KEY-----
              MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEOXYta5TgdCwXTCnLU09W5T4M4r9f
              QQrqJuADP6U7g5r9ICgPSmZuRHP/1AYUfOQW3baveKsT969EfELKj1lfCA==
              -----END PUBLIC KEY-----
          - name: sse
            key: |
              -----BEGIN PUBLIC KEY-----
              MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsx28WV7BsQfnHF1kZmpdCTTLJaWe
              d0CA+JOi8H4REuBaWSZ5zPDe468WuOJ6f71E7WFg3CVEVYHuoZt2UYbN/Q==
              -----END PUBLIC KEY-----

  - variable: application.policy
    label: "策略规则（policy）"
    description: |
      以 YAML 数组格式编辑。可任意新增或删除策略条目。
      ➤ 新增规则时，复制上一条 pattern，补充、修改后即可。
      ➤ 删除无用规则直接删掉相关条。

      示例（可参考编辑）：
        - pattern: "*:*"
          validator: deny
        - pattern: "docker.io/library/*:*"
          validator: dockerhub
        - pattern: "docker.io/securesystemsengineering/*:*"
          validator: dockerhub
          with:
            trustRoot: sse
        - pattern: "registry.k8s.io/*:*"
          validator: allow
    type: multiline
    required: true
    group: "策略规则"
    default: |-
      - pattern: "*:*"
        validator: deny
      - pattern: "docker.io/library/*:*"
        validator: dockerhub
      - pattern: "docker.io/securesystemsengineering/*:*"
        validator: dockerhub
        with:
          trustRoot: sse
      - pattern: "registry.k8s.io/*:*"
        validator: allow
