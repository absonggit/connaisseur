questions:
  # 日志配置
  - variable: application.logLevel
    label: "日志级别"
    description: "设置日志详细程度"
    type: enum
    default: info
    options:
      - info
      - warning
      - debug
      - error
    group: "日志配置"

  - variable: application.logFormat
    label: "日志格式"
    description: "日志输出格式"
    type: enum
    default: json-pretty
    options:
      - json-pretty
      - plain
    group: "日志配置"

  # 功能特性
  - variable: application.features.automaticUnchangedApproval
    label: "自动批准未变更镜像"
    type: boolean
    default: false
    group: "功能特性"

  - variable: application.features.automaticChildApproval
    label: "自动批准子资源"
    type: boolean
    default: true
    group: "功能特性"

  - variable: application.features.detectionMode
    label: "只警告不拒绝"
    description: "启用后所有校验仅产生警告不拒绝部署"
    type: boolean
    default: false
    group: "功能特性"

  - variable: application.features.namespacedValidation.mode
    label: "命名空间校验模式"
    description: "选择是否只在特定命名空间校验"
    type: enum
    options:
      - ignore
      - validate
    default: ignore
    group: "功能特性"

  - variable: application.features.resourceValidationMode
    label: "资源校验范围"
    description: "校验所有资源或仅校验 Pod"
    type: enum
    options:
      - all
      - podsOnly
    default: all
    group: "功能特性"

  - variable: application.features.cache.expirySeconds
    label: "缓存超时时间（秒）"
    type: int
    default: 30
    group: "功能特性"

  - variable: application.features.cache.cacheErrors
    label: "缓存校验失败"
    type: boolean
    default: true
    group: "功能特性"

  # 策略规则
  - variable: application.policy
    label: "镜像策略规则"
    description: |
      镜像策略规则，按 YAML 数组格式编辑，示例已提供。每条规则 pattern 支持通配。
    type: multiline
    default: |-
      - pattern: "*:*"
        validator: deny
      - pattern: "docker.io/library/*:*"
        validator: dockerhub
      - pattern: "docker.io/securesystemsengineering/*:*"
        validator: dockerhub
        with:
          trustRoot: sse
      - pattern: "registry.k8s.io/*:*"
        validator: allow
    group: "策略规则"

  # 校验器
  - variable: application.validators
    label: "校验器设置"
    description: |
      支持 NotaryV1、Cosign 等校验方式，按 YAML 格式配置。示例为默认推荐配置。
    type: multiline
    default: |-
      - name: allow
        type: static
        approve: true
      - name: deny
        type: static
        approve: false
      - name: dockerhub
        type: notaryv1
        trustRoots:
          - name: default
            key: |
              -----BEGIN PUBLIC KEY-----
              MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEOXYta5TgdCwXTCnLU09W5T4M4r9f
              QQrqJuADP6U7g5r9ICgPSmZuRHP/1AYUfOQW3baveKsT969EfELKj1lfCA==
              -----END PUBLIC KEY-----
          - name: sse
            key: |
              -----BEGIN PUBLIC KEY-----
              MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEsx28WV7BsQfnHF1kZmpdCTTLJaWe
              d0CA+JOi8H4REuBaWSZ5zPDe468WuOJ6f71E7WFg3CVEVYHuoZt2UYbN/Q==
              -----END PUBLIC KEY-----
    group: "校验器"
